<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
         "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ssafy.house.model.dao.HouseInfoDao">
    <resultMap id="houseInfoMap" type="com.ssafy.house.model.dto.HouseInfo">
        <id column="apt_seq" property="aptSeq"/>
        <result column="sgg_cd" property="sggCd"/>
        <result column="umd_cd" property="umdCd"/>
        <result column="umd_nm" property="umdNm"/>
        <result column="jibun" property="jibun"/>
        <result column="road_nm_sgg_cd" property="roadNmSggCd"/>
        <result column="road_nm" property="roadNm"/>
        <result column="road_nm_bonbun" property="roadNmBonbun"/>
        <result column="road_nm_bubun" property="roadNmBubun"/>
        <result column="apt_nm" property="aptNm"/>
        <result column="build_year" property="buildYear"/>
        <result column="latitude" property="latitude"/>
        <result column="longitude" property="longitude"/>
    </resultMap>

    <!-- 전체 조회 -->
    <select id="selectHouseInfoAll" resultMap="houseInfoMap">
        SELECT * FROM house_info
    </select>

    <!-- 단일 조회 -->
    <select id="selectHouseInfo" parameterType="string" resultMap="houseInfoMap">
        SELECT * FROM house_info
         WHERE apt_seq = #{aptSeq}
    </select>

    <!-- 범위 조회 -->
    <select id="selectByBounds" resultMap="houseInfoMap">
        SELECT * FROM house_info
         WHERE latitude  BETWEEN #{minLat}  AND #{maxLat}
           AND longitude BETWEEN #{minLng} AND #{maxLng}
    </select>

    <!-- 삽입 -->
    <insert id="insertHouseInfo" parameterType="com.ssafy.house.model.dto.HouseInfo">
        INSERT INTO house_info (
            apt_seq, sgg_cd, umd_cd, umd_nm, jibun,
            road_nm_sgg_cd, road_nm, road_nm_bonbun, road_nm_bubun,
            apt_nm, build_year, latitude, longitude
        ) VALUES (
            #{aptSeq}, #{sggCd}, #{umdCd}, #{umdNm}, #{jibun},
            #{roadNmSggCd}, #{roadNm}, #{roadNmBonbun}, #{roadNmBubun},
            #{aptNm}, #{buildYear}, #{latitude}, #{longitude}
        )
    </insert>

    <!-- 수정 -->
    <update id="updateHouseInfo" parameterType="com.ssafy.house.model.dto.HouseInfo">
        UPDATE house_info
           SET sgg_cd           = #{sggCd},
               umd_cd           = #{umdCd},
               umd_nm           = #{umdNm},
               jibun            = #{jibun},
               road_nm_sgg_cd   = #{roadNmSggCd},
               road_nm          = #{roadNm},
               road_nm_bonbun   = #{roadNmBonbun},
               road_nm_bubun    = #{roadNmBubun},
               apt_nm           = #{aptNm},
               build_year       = #{buildYear},
               latitude         = #{latitude},
               longitude        = #{longitude}
         WHERE apt_seq = #{aptSeq}
    </update>

    <!-- 삭제 -->
    <delete id="deleteHouseInfo" parameterType="string">
        DELETE FROM house_info
         WHERE apt_seq = #{aptSeq}
    </delete>
</mapper>
